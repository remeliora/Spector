# Основные изменения COMMIT_10

### (03.05.2024)

### В общем из основного:

## 1) Решена проблема с `fetchType`

Из-за того что каждый слой приложения работает с разным типом подгрузки `fetchType.EAGER` нельзя использовать везде. 
Данный тип подходит только для скрипта-опроса и некоторых других модулей.
Его также надо использовать только в родительских таблицах (связь **OneToMany**).
`fetchType.LAZY` напротив надо использовать только в дочерних таблицах (связь **ManyToOne**), дабы уменьшить нагрузку на БД.
Собственно из-за разно типа подгрузки была проблема с удалением записей из связанных дочерних таблиц.

## 2) Решена проблема с `fetchType.LAZY` и работой скрипта

При работе скрипта с данным типом подгрузки данных возникала ошибка, что нехватает данных в рамках одной транзакции.
Решение проблемы оказалось очень простым - необходимо было аннотировать под транзакцию не только метод сбора данных, а и вместе с ним весь класс скрипта опроса.

## 3) Избавился от аннотации `@Autowired`

Данная аннотация по документации Spring Boot уже является устаревшей и работающей со сбоями.
Вместо неё теперь используется `@RequiredArgsConstructor`

## 4) Реализован слой DTO

Реализовал слой DTO (Data transfer object) для изолированной работы с web-интерфейсом и БД.
Контроллеры и http-шаблоны также работают через DTO (в дальнейшей перспективе планируется реализовать работу через DTO в сервисах и rest-контроллерах)





